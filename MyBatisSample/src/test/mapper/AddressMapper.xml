<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper 
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="test.mapper.AddressMapper">
	<select id="selectAddress" parameterType="int" resultType="Address">
		select * from Person.Address where AddressID = #{id}  
	</select>
	
	<!-- parameterMap已經不能用了！ -->
	<select id="queryAddress" parameterType="HashMap" resultType="Address">
		select * from Person.Address
		<where>
			<if test="id != null">
				AddressID = #{id}  
			</if>
			<!-- <if test="city != null">
				AND City like #{city}
			</if> -->
			
			<!-- collection可以是Array或是List -->
			<!-- 第二筆開始都要加上ADD，第一筆加ADD也不會錯！ -->
			<if test="city != null">
				AND City in
				<foreach item="item" index="index" collection="city" open="(" separator="," close=")">
					#{item} 
			    </foreach>
			</if>
		</where>
	</select>
	
	<update id="updateAddress" parameterType="Address">
		update Person.Address
		<set>
			<if test="addressID != null and addressLine2 !=null">
				AddressLine2 = '${addressLine2}'
			</if>
		</set>
		where AddressID = ${addressID}
	</update>
</mapper> 